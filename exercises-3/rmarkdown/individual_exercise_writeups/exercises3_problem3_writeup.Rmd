---
title: "Exercise 3"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggthemes)
library(LICORS)
library(knitr)

# read data
setwd("~/UT Courses/3. Spring 2019/Data Mining, Statistical Learning/Homework/DataScienceCourseHomework/exercises-3")
wine_data = read.csv("./data/wine.csv")

# separate data into inputs and outcomes
wine_x = wine_data[,1:11]
wine_score = wine_data[,12]
wine_color = wine_data[,13]

# standardize data
wine_x_st = scale(wine_x)
```
In this exercise, we analyze data on the chemical properties of 6500 different bottles of *vinho verde* wine from northern Portugal. We compare principal component analysis (PCA) and K-means++ clustering to choose a method that easily distinguishes between red and white wine. We further investigate the ability of each method to sort higher quality wines from lower quality wines. We find that K-means++ is better for the application of distinguishing white wine from red but that PCA captures more information about wine quality.

### PCA

```{r pca, include=FALSE}
# calculate principal components
pc_wine = prcomp(wine_x_st, scale=TRUE)

# add outcomes back in for graphing
pc_wine_graph_data = as.data.frame(pc_wine$x)
pc_wine_graph_data$score = wine_score
pc_wine_graph_data$color = wine_color
```

```{r pca_scatter_color, echo=FALSE}
ggplot(data = pc_wine_graph_data) +
  geom_point(aes(x = PC1, y = PC2, color = color), alpha = 1/4) +
  theme_clean() +
  theme(plot.background=element_blank()) +
  scale_color_manual(values = c("#722f37", "#eccd13"))
```

```{r pca_box_color, echo=FALSE}
ggplot(data = pc_wine_graph_data) +
  geom_boxplot(aes(x = color, y = PC1)) +
  theme_clean() +
  theme(plot.background=element_blank())
```

```{r pca_scatter_score, echo=FALSE}
ggplot(data = pc_wine_graph_data) +
  geom_point(aes(x = PC1, y = PC2, color = as.factor(score))) +
  theme_clean() +
  theme(plot.background=element_blank())
```

```{r pca_box_score_pc1, echo=FALSE}
ggplot(data = pc_wine_graph_data) +
  geom_boxplot(aes(x = as.factor(score), y = PC1)) +
  theme_clean() +
  theme(plot.background=element_blank())
```

```{r pca_box_score_pc2, echo=FALSE}
ggplot(data = pc_wine_graph_data) +
  geom_boxplot(aes(x = as.factor(score), y = PC2)) +
  theme_clean() +
  theme(plot.background=element_blank())
```

```{r pca_box_score_pc3, echo=FALSE}
ggplot(data = pc_wine_graph_data) +
  geom_boxplot(aes(x = as.factor(score), y = PC3)) +
  theme_clean() +
  theme(plot.background=element_blank())
```

```{r pca_table_score, echo=FALSE}
pca_table = pc_wine_graph_data %>%
  group_by(score) %>%
  summarize(mean.PC1 = mean(PC1), mean.PC2 = mean(PC2), mean.PC3 = mean(PC3))
```

### K-Means++

```{r k_meanspp_color, echo=FALSE}
wine_cluster_color = kmeanspp(wine_x_st, k=2, nstart=50)

cluster_wine_data = wine_data
cluster_wine_data$two_clusters = wine_cluster_color$cluster
```

```{r results='asis', echo=FALSE}
table_color = table(color = cluster_wine_data$color, 
              cluster = cluster_wine_data$two_clusters)

knitr::kable(table_color, 
             caption = "Table 1: Cluster (horizontal) vs. color (vertical)", 
             col.names = c("Cl 1", "Cl 2"))
```

```{r k_meanspp_score, echo=FALSE}
wine_cluster_score = kmeanspp(wine_x_st, k=7, nstart=100)

cluster_wine_data$seven_clusters = wine_cluster_score$cluster
```

```{r results='asis', echo=FALSE}
table_score = table(score = cluster_wine_data$quality, 
                    cluster = cluster_wine_data$seven_clusters)
knitr::kable(table_score,
             caption = "Table 2: Cluster (horizontal) vs. quality score (vertical)",
             col.names = c("Cl 1", "Cl 2", "Cl 3", "Cl 4", "Cl 5", "Cl 6", "Cl 7"))
```

### Which is better here?